---
created: 2023-09-26T22:29:22 (UTC +08:00)
tags: []
source: https://voxel-tools.readthedocs.io/en/latest/streams/
author: 
---

# Streams流

> ## Excerpt
> VoxelStream allows to save and load voxel data to a file or a directory structure, using various kinds of implementations. They don't hold voxel data in memory, they are just an access point. VoxelStream 允许使用各种实现将体素数据保存和加载到文件或目录结构中。它们不将体素数据保存在内存中，它们只是一个接入点。

---
`VoxelStream` allows to save and load voxel data to a file or a directory structure, using various kinds of implementations. They don't hold voxel data in memory, they are just an access point.  
`VoxelStream` 允许使用各种实现将体素数据保存和加载到文件或目录结构中。它们不将体素数据保存在内存中，它们只是一个接入点。

## Stream types 流类型

A few different types are available, each with slightly different features.  
有几种不同的类型可供选择，每种类型的功能略有不同。

`VoxelStreamSQLite` is the most featured one, and uses a single SQLite database file. It can save both voxel data and [instancing](https://voxel-tools.readthedocs.io/en/latest/instancing/) data.  
`VoxelStreamSQLite` 是功能最强的一个，并使用单个 SQLite 数据库文件。它可以保存体素数据和实例化数据。

`VoxelStreamRegionFiles` is an older one, which works similarly to Minecraft's region system. It saves under multiple files in a folder. It only supports voxel data.  
`VoxelStreamRegionFiles` 是一个较旧的，其工作原理类似于Minecraft的区域系统。它保存在一个文件夹中的多个文件下。它仅支持体素数据。

`VoxelStreamScript` is a custom stream that may be implemented using a script. See [Scripting](https://voxel-tools.readthedocs.io/en/latest/scripting/#custom-stream).  
`VoxelStreamScript` 是可以使用脚本实现的自定义流。请参阅脚本。

There is currently no stream implementation using an existing file format (like `.vox` for example), mainly because the current API expects the ability to load data in chunks compatible with the engine's format.  
目前没有使用现有文件格式（例如 `.vox` ）的流实现，主要是因为当前的 API 希望能够以与引擎格式兼容的块加载数据。

## Using streams for savegames  
使用流进行保存游戏

Streams were created initially to serve as a database for saves. Games using voxel technology for terrain are often persistent, so there has to be a place on disk where to save the changes, and reload them back.  
创建流最初是为了用作保存的数据库。对地形使用体素技术的游戏通常是永久性的，因此磁盘上必须有一个位置来保存更改，然后重新加载它们。

The engine can handle near-unlimited terrain size, so there are often situations where loading the entire world in memory is not possible. For that reason, streams are built in such a way they provide data block by block (or "chunks"). Only blocks near the player will be loaded in memory. When the player moves, blocks far away will get unloaded/saved, while blocks getting closer will be loaded.  
该引擎可以处理近乎无限的地形大小，因此经常存在无法将整个世界加载到内存中的情况。出于这个原因，流是以这样一种方式构建的，它们逐块（或“块”）提供数据。只有玩家附近的方块才会加载到内存中。当玩家移动时，远处的方块将被卸载/保存，而越来越近的方块将被加载。

By default, only modified blocks are saved. However, if the generator you use is too expensive to re-run on demand, it can be configured such that every new block will always get saved. This is the case in Minecraft.  
默认情况下，仅保存修改后的块。但是，如果您使用的生成器太昂贵而无法按需重新运行，则可以对其进行配置，以便始终保存每个新块。《我的世界》就是这种情况。

When voxels are edited, modified blocks are not saved immediately. This is because many edits could keep happening, and trying to save too often could be wasteful.  
编辑体素时，修改后的块不会立即保存。这是因为许多编辑可能会不断发生，并且尝试过于频繁地保存可能会浪费。

Saving only occurs under the following conditions:  
仅在以下情况下进行保存：

-   The block gets unloaded when too far away  
    距离太远时块被卸载
-   `save_modified_blocks()` is called on the terrain node (you may want to call this when the player saves, or quits the game)  
    `save_modified_blocks()` 在地形节点上调用（您可能希望在玩家保存或退出游戏时调用此节点）

## Using streams in the Godot Editor  
在戈多编辑器中使用流

At the moment, streams can run in the editor, but they behave the same as if the game was running. If you modify anything, blocks will eventually get saved under the same conditions as seen earlier. If you want to preserve your game saves, either leave the `stream` property unassigned, or you can assign a "development save" on the stream in the editor. Then, assign a different path from within your game to the real save (using script).  
目前，流可以在编辑器中运行，但它们的行为与游戏正在运行的行为相同。如果您修改任何内容，块最终将在与前面相同的条件下保存。如果要保留游戏存档，请保留未分配 `stream` 的属性，也可以在编辑器中为流分配“开发存档”。然后，从游戏中分配与实际存档不同的路径（使用脚本）。

If you use the same save files between game and editor, there is a risk of conflict when you run the game: it will try to open files which are already opened and locked by the editor. To workaround this, either use different files, or close the scene before running the game. See [issue 283](https://github.com/Zylann/godot_voxel/issues/283).  
如果您在游戏和编辑器之间使用相同的存档文件，则在运行游戏时存在冲突的风险：它将尝试打开编辑器已经打开和锁定的文件。若要解决此问题，请使用其他文件，或在运行游戏之前关闭场景。请参阅问题 283。

## Save format specifications  
保存格式规范

-   [Region format 区域格式](https://voxel-tools.readthedocs.io/en/latest/specs/region_format_v3/)
-   [Block format 块格式](https://voxel-tools.readthedocs.io/en/latest/specs/block_format_v2/)
-   [SQLite format SQLite 格式](https://voxel-tools.readthedocs.io/en/latest/specs/sqlite_format/)
